<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Pixel Love Story ‚ù§Ô∏è</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-pink: #ff85a1;
            --dark-pink: #ff477e;
            --light-blue: #a7d9ff;
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: linear-gradient(to bottom, #ffc2d1 0%, #ffe5ec 100%);
            font-family: 'Press Start 2P', cursive;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
        }

        #game-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 5;
            pointer-events: none;
        }

        #story-box {
            position: relative;
            z-index: 10;
            text-align: center;
            background: rgba(255, 255, 255, 0.9);
            border: 6px solid #333;
            box-shadow: 10px 10px 0px rgba(0,0,0,0.1);
            padding: 25px;
            max-width: 85%;
            width: 480px;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
        }

        .pixel-photo {
            width: 130px;
            height: 130px;
            border: 4px solid #fff;
            box-shadow: 4px 4px 0px #333;
            image-rendering: pixelated;
            object-fit: cover;
            margin: 10px;
            display: none; 
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        #scene-img {
            width: 280px;
            height: 200px;
            border: 4px solid #333;
            background: #eee;
            image-rendering: pixelated;
            display: none;
            margin-bottom: 10px;
            object-fit: cover;
            animation: popIn 0.6s ease-out forwards;
        }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        #content-area {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
        }

        #typewriter-text {
            font-size: 11px;
            line-height: 1.8;
            height: 80px;
            margin-top: 15px;
        }

        .controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            z-index: 20;
        }

        button {
            padding: 10px;
            font-family: 'Press Start 2P', cursive;
            font-size: 8px;
            background: #fff;
            border: 3px solid #333;
            cursor: pointer;
            box-shadow: 4px 4px 0px #333;
        }

        button:active { transform: translate(2px, 2px); box-shadow: 0px 0px 0px; }

        #easter-egg { position: absolute; top: 10px; right: 10px; opacity: 0.3; cursor: pointer; }
    </style>
</head>
<body>

    <canvas id="canvas"></canvas>

    <div id="game-container">
        <div id="story-box">
            <div id="easter-egg" onclick="triggerEasterEgg()">‚≠ê</div>
            
            <div id="content-area">
                <div id="photo-group">
                    <img id="her-photo" class="pixel-photo" src="her.png" alt="Her">
                    <img id="my-photo" class="pixel-photo" src="us.jpeg" alt="Me">
                </div>
                <img id="scene-img" src="" alt="Scene Illustration">
                <div id="typewriter-text"></div>
            </div>
        </div>

        <div class="controls">
            <button onclick="playMusic()">üéµ Music</button>
            <button onclick="resetStory()">üîÑ Replay</button>
        </div>
    </div>

   <audio id="bg-music" loop>
    <source src="rossong.mp3" type="audio/mpeg">
</audio>


    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const textEl = document.getElementById('typewriter-text');
        const herImg = document.getElementById('her-photo');
        const myImg = document.getElementById('my-photo');
        const sceneImg = document.getElementById('scene-img');
        const music = document.getElementById('bg-music');

        let particles = [];
        let width, height;

        // Path update: img/ removed from all keys
        const images = {
            wedding: "wedding.png",
            family: "family.png",
            forever3: "forever3.jpg",
            end: "end.jpeg"
        };

        const story = [
            { text: "Happy Birthday ROSHNI ‚ù§Ô∏è", action: () => { herImg.style.display = 'inline-block'; createConfetti(); } },
            { text: "You make my world brighter üåü", action: () => { myImg.style.display = 'inline-block'; createHeartBurst(width/2, height/2); } },
            { text: "I love you, today & always üíñ", action: () => {} },
            { text: "Let's make our life full of love and adventure üíï", action: () => {} },
            { 
                text: "Our journey together started with a simple smile...", 
                action: () => { 
                    herImg.style.display = 'none'; myImg.style.display = 'none';
                    sceneImg.src = images.wedding; sceneImg.style.display = 'block';
                    createConfetti(); 
                } 
            },
            { 
                text: "Our home will be filled with laughter, love, and little feet...", 
                action: () => { sceneImg.src = images.family; createConfetti(); } 
            },
            { 
                text: "One day, we‚Äôll say 'I do' and promise forever...", 
                action: () => { sceneImg.src = images.forever3; createHeartBurst(width/2, height/2); } 
            },
            { 
                text: "The End!! Please click restart to play again.", 
                action: () => { sceneImg.src = images.end; createHeartBurst(width/2, height/2); } 
            }
        ];

        let step = 0;

        function typeWriter(index) {
            if (index >= story.length) return;
            let charIdx = 0;
            textEl.innerHTML = "";
            story[index].action();

            const interval = setInterval(() => {
                textEl.innerHTML += story[index].text.charAt(charIdx);
                charIdx++;
                if (charIdx >= story[index].text.length) {
                    clearInterval(interval);
                    setTimeout(() => { step++; typeWriter(step); }, 3500);
                }
            }, 70);
        }

        // --- Particle Engine ---
        function resize() { width = canvas.width = window.innerWidth; height = canvas.height = window.innerHeight; }
        window.addEventListener('resize', resize); resize();

        class Particle {
            constructor(x, y, color, type) {
                this.x = x; this.y = y; this.color = color; this.type = type;
                this.vx = (Math.random() - 0.5) * 10; this.vy = (Math.random() - 0.5) * 10;
                this.life = 100;
            }
            update() { this.x += this.vx; this.y += this.vy; if(this.type === 'float') this.y -= 2; this.life -= 1.5; }
            draw() {
                ctx.save();
                ctx.globalAlpha = Math.max(0, this.life / 100);
                if (this.type === 'heart-shape') {
                    const s = 4;
                    const pattern = [[0,1,0,1,0],[1,1,1,1,1],[1,1,1,1,1],[0,1,1,1,0],[0,0,1,0,0]];
                    for (let r=0; r<5; r++) for (let c=0; c<5; c++) if(pattern[r][c]) { ctx.fillStyle = this.color; ctx.fillRect(this.x + c*s, this.y + r*s, s, s); }
                } else {
                    ctx.fillStyle = this.color; ctx.fillRect(this.x, this.y, 5, 5);
                }
                ctx.restore();
            }
        }

        function createConfetti() { for(let i=0; i<40; i++) particles.push(new Particle(width/2, height/2, `hsl(${Math.random()*360},70%,60%)`, 'burst')); }
        function createHeartBurst(x, y) { for(let i=0; i<15; i++) particles.push(new Particle(x, y, '#ff477e', 'heart-shape')); }

        function animate() {
            ctx.clearRect(0,0,width,height);
            if(Math.random() < 0.05) particles.push(new Particle(Math.random()*width, height, '#ff85a1', 'float'));
            particles = particles.filter(p => p.life > 0);
            particles.forEach(p => { p.update(); p.draw(); });
            requestAnimationFrame(animate);
        }

        window.addEventListener('click', (e) => createHeartBurst(e.clientX, e.clientY));
        function playMusic() { music.play(); }
        function resetStory() { step = 0; herImg.style.display = 'none'; myImg.style.display = 'none'; sceneImg.style.display = 'none'; typeWriter(0); }
        function triggerEasterEgg() { alert("I promise to love you in every universe. üëæ"); createConfetti(); }

        animate();
        typeWriter(0);
    </script>
</body>
</html>